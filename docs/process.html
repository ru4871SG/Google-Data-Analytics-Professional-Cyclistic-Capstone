<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Data Analysis Process with R</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Google Capstone Project - Cyclistic</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Report</a>
</li>
<li>
  <a href="process.html">Data Analysis Process with R</a>
</li>
<li>
  <a href="misc.html">Data Analysis Process with SQL</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Data Analysis Process with R</h1>

</div>


<p><br></p>
<div id="explanation" class="section level1">
<h1>Explanation</h1>
<hr>
<p>This page explains all the processes for my data cleaning,
transformation, and analyses with RStudio. Everything that you see on
the
<a href="https://ru4871sg.github.io/Google-Data-Analytics-Professional-Cyclistic-Capstone/index.html">Report
page</a> was made possible thanks to all the steps explained below.</p>
<p>And I also re-created all the below steps using SQL with BigQuery for
my learning purposes. The analysis results are consistent between SQL
and R. <br><br></p>
</div>
<div id="download-trip-data-and-rename-the-files"
class="section level1">
<h1>1. Download Trip Data and Rename the Files</h1>
<hr>
<p>Download Divvy Bikes trip data from January 2022 up to December 2022.
There are 12 csv files in total. Rename all the csv files to
<b>cyclistic_tripdata_202201.csv</b>,
<b>cyclistic_tripdata_202202.csv</b>, etc. to make them look
consistent.<br><br></p>
</div>
<div id="import-data-to-rstudio-and-preview-them"
class="section level1">
<h1>2. Import Data to Rstudio and Preview Them</h1>
<hr>
<p>Import all the .csv files to Rstudio:</p>
<pre class="r"><code>cyclistic_202201 &lt;- read_csv(&quot;cyclistic_tripdata_202201.csv&quot;)
cyclistic_202202 &lt;- read_csv(&quot;cyclistic_tripdata_202202.csv&quot;)
cyclistic_202203 &lt;- read_csv(&quot;cyclistic_tripdata_202203.csv&quot;)
cyclistic_202204 &lt;- read_csv(&quot;cyclistic_tripdata_202204.csv&quot;)
cyclistic_202205 &lt;- read_csv(&quot;cyclistic_tripdata_202205.csv&quot;)
cyclistic_202206 &lt;- read_csv(&quot;cyclistic_tripdata_202206.csv&quot;)
cyclistic_202207 &lt;- read_csv(&quot;cyclistic_tripdata_202207.csv&quot;)
cyclistic_202208 &lt;- read_csv(&quot;cyclistic_tripdata_202208.csv&quot;)
cyclistic_202209 &lt;- read_csv(&quot;cyclistic_tripdata_202209.csv&quot;)
cyclistic_202210 &lt;- read_csv(&quot;cyclistic_tripdata_202210.csv&quot;)
cyclistic_202211 &lt;- read_csv(&quot;cyclistic_tripdata_202211.csv&quot;)
cyclistic_202212 &lt;- read_csv(&quot;cyclistic_tripdata_202212.csv&quot;)</code></pre>
<p><br> Next, preview all of them:</p>
<pre class="r"><code>str(cyclistic_202201)
str(cyclistic_202202)
str(cyclistic_202203)
str(cyclistic_202204)
str(cyclistic_202205)
str(cyclistic_202206)
str(cyclistic_202207)
str(cyclistic_202208)
str(cyclistic_202209)
str(cyclistic_202210)
str(cyclistic_202211)
str(cyclistic_202212)</code></pre>
<p><br> Looks like all of them are consistent. both
<code>started_at</code> and <code>ended_at</code> are already in
<i>POSIXct</i>. No need to change any data type.
<code>start_station_id</code> and <code>end_station_id</code> are also
in <i>chr</i> already.<br><br></p>
</div>
<div id="merge-all-of-them" class="section level1">
<h1>3. Merge All of Them</h1>
<hr>
<p>Merge all of them using <code>bind_rows()</code>:</p>
<pre class="r"><code>cyclistic_2022 &lt;- bind_rows(
     cyclistic_202201, cyclistic_202202, cyclistic_202203, cyclistic_202204,
     cyclistic_202205, cyclistic_202206, cyclistic_202207, cyclistic_202208,
     cyclistic_202209, cyclistic_202210, cyclistic_202211, cyclistic_202212
 )</code></pre>
<p><br><br></p>
</div>
<div id="sort-dataset" class="section level1">
<h1>4. Sort Dataset</h1>
<hr>
<p>Next, sort <code>cyclistic_2022</code> by <code>started_at</code> to
ensure the first row is the oldest:</p>
<pre class="r"><code>cyclistic_2022 &lt;- cyclistic_2022 %&gt;% arrange(started_at)</code></pre>
<p><br><br></p>
</div>
<div id="calculate-ride_length-and-day_of_week" class="section level1">
<h1>5. Calculate ride_length and day_of_week</h1>
<hr>
<p>Prior to data cleaning, it’s better to calculate
<code>ride_length</code> and <code>day_of_week</code>:</p>
<pre class="r"><code>cyclistic_2022 &lt;- cyclistic_2022 %&gt;% mutate(ride_length = ended_at - started_at)</code></pre>
<p><br> and</p>
<pre class="r"><code>cyclistic_2022$day_of_week &lt;- wday(cyclistic_2022$started_at)</code></pre>
<p>Both <code>day_of_week</code> and <code>ride_length</code> will be
used for further analyses.<br><br></p>
</div>
<div id="first-process-of-data-cleaning" class="section level1">
<h1>6. First Process of Data Cleaning</h1>
<hr>
<p>According to Divvy’s data policy, anything below 60 seconds should
not be included.</p>
<p>Let’s just filter out all the negative values, and anything below 60
secs:</p>
<pre class="r"><code>cyclistic_2022_cleaned &lt;- cyclistic_2022 %&gt;% filter(!(ride_length &lt; 60))</code></pre>
<p><br> Once I find out there is no negative ride_length anymore, I
leave out all the <code>NULL</code> values as well:</p>
<pre class="r"><code>cyclistic_2022_cleaned &lt;- cyclistic_2022_cleaned %&gt;% drop_na()</code></pre>
<p><br><br></p>
</div>
<div id="check-other-possibilities-for-further-data-cleaning"
class="section level1">
<h1>7. Check Other Possibilities for Further Data Cleaning</h1>
<hr>
<p>Check all uppercase or all lowercase values to find naming
inconsistencies. Let’s go back to the pre-cleaned data frame just to
preview all the inconsistencies.</p>
<pre class="r"><code>check_df &lt;- cyclistic_2022 %&gt;% filter(toupper(start_station_name) == start_station_name)</code></pre>
<p><br> looks like there are some “test” or “maintenance” station names
and IDs. For example, some <code>start_station_name</code> rows are
<b>WEST CHI-WATSON</b> which show the <code>start_station_id</code> as
<b>DIVVY 001 - Warehouse test station</b>. This needs to be
filtered.</p>
<p>Next, let’s investigate <code>end_station_name</code>:</p>
<pre class="r"><code>check_df &lt;- cyclistic_2022 %&gt;% filter(toupper(end_station_name) == end_station_name)</code></pre>
<p><br> Just like before, there are couple of rows with value <b>DIVVY
CASSETTE REPAIR MOBILE STATION</b>, which means this is just used for
maintenance, not for actual trips. This needs to be filtered as
well.</p>
<p>However, there is no result for <code>filter(tolower())</code> for
both <code>start_station_name</code> and
<code>end_station_name</code>.</p>
<p>Next, let’s check if any row has the word “test” or “Test” or
“TEST”:</p>
<pre class="r"><code>check_df &lt;- cyclistic_2022 %&gt;% 
    filter(str_detect(start_station_name, &quot;test|Test|TEST&quot;) | 
               str_detect(end_station_name, &quot;test|Test|TEST&quot;) | 
               str_detect(start_station_id, &quot;test|Test|TEST&quot;) | 
               str_detect(end_station_id, &quot;test|Test|TEST&quot;))</code></pre>
<p><br> Looks like there are plenty of <b>Hubbard Bike-checking
(LBS-WH-TEST)</b>, <b>Pawel Bialowas - Test- PBSC charging station</b>
and <b>DIVVY 001 - Warehouse test station</b>.</p>
<p>I assume these are test trips. They need to be filtered
too.<br><br></p>
</div>
<div id="final-data-cleaning" class="section level1">
<h1>8. Final Data Cleaning</h1>
<hr>
<p>Let’s go back to <code>cyclistic_2022_cleaned</code> (step 6 above),
and include all of the findings from step 7:</p>
<pre class="r"><code>cyclistic_2022_cleaned &lt;- cyclistic_2022_cleaned %&gt;% filter(toupper(start_station_name) != start_station_name) %&gt;% filter(toupper(end_station_name) != end_station_name) %&gt;% 
        filter(!str_detect(start_station_name, &quot;test|Test|TEST&quot;) &amp; 
                   !str_detect(end_station_name, &quot;test|Test|TEST&quot;) &amp; 
                   !str_detect(start_station_id, &quot;test|Test|TEST&quot;) &amp; 
                   !str_detect(end_station_id, &quot;test|Test|TEST&quot;))</code></pre>
<p><br> To ensure there’s no duplicate id, let’s check with
<code>duplicated()</code>:</p>
<pre class="r"><code>cyclistic_2022_cleaned[!duplicated(cyclistic_2022_cleaned$ride_id), ]</code></pre>
<p><br> Apparently, there are exact same number of rows as before. All
good, no need to save this.</p>
<p>Next, let’s detect if there are trailing/leading spaces and other
unnecessary symbols.</p>
<p>After checking the <code>start_station_name</code> and
<code>end_station_name</code> manually, I found out that there is a
certain symbol used after the end of the station name, which is
<b>*</b>.</p>
<p>I also found out that certain stations ended up with <b>(Temp)</b>
and <b>- Charging</b>. To avoid duplicate station names during analysis
stage later on, these stations should be cleaned as well.</p>
<p>We clean the data by using <code>gsub()</code>:</p>
<pre class="r"><code>cyclistic_2022_cleaned$start_station_name &lt;- gsub(&quot;\\*&quot;, &quot;&quot;, cyclistic_2022_cleaned$start_station_name)

cyclistic_2022_cleaned$start_station_name &lt;- gsub(&quot;\\(Temp)&quot;, &quot;&quot;, cyclistic_2022_cleaned$start_station_name)

cyclistic_2022_cleaned$start_station_name &lt;- gsub(&quot;\\ - Charging&quot;, &quot;&quot;, cyclistic_2022_cleaned$start_station_name)</code></pre>
<p><br> Let’s do the same for <code>end_station_name</code>:</p>
<pre class="r"><code>cyclistic_2022_cleaned$end_station_name &lt;- gsub(&quot;\\*&quot;, &quot;&quot;, cyclistic_2022_cleaned$end_station_name)
    
cyclistic_2022_cleaned$end_station_name &lt;- gsub(&quot;\\(Temp)&quot;, &quot;&quot;, cyclistic_2022_cleaned$end_station_name)
    
cyclistic_2022_cleaned$end_station_name &lt;- gsub(&quot;\\ - Charging&quot;, &quot;&quot;, cyclistic_2022_cleaned$end_station_name)</code></pre>
<p><br> And then, for the rest of data cleaning:</p>
<pre class="r"><code>cyclistic_2022_cleaned$start_station_name &lt;- gsub(&quot;^\\s+|\\s+$&quot;, &quot;&quot;, cyclistic_2022_cleaned$start_station_name)

cyclistic_2022_cleaned$end_station_name &lt;- gsub(&quot;^\\s+|\\s+$&quot;, &quot;&quot;, cyclistic_2022_cleaned$end_station_name)

cyclistic_2022_cleaned$member_casual &lt;- gsub(&quot;^\\s+|\\s+$&quot;, &quot;&quot;, cyclistic_2022_cleaned$member_casual)

cyclistic_2022_cleaned$rideable_type &lt;- gsub(&quot;^\\s+|\\s+$&quot;, &quot;&quot;, cyclistic_2022_cleaned$rideable_type)

cyclistic_2022_cleaned$start_station_id &lt;- gsub(&quot;^\\s+|\\s+$&quot;, &quot;&quot;, cyclistic_2022_cleaned$start_station_id)

cyclistic_2022_cleaned$end_station_id &lt;- gsub(&quot;^\\s+|\\s+$&quot;, &quot;&quot;, cyclistic_2022_cleaned$end_station_id)</code></pre>
<p><br> Above steps ensures no trailing/leading whitespaces and
unnecessary symbols in the naming processes.<br><br></p>
</div>
<div id="analyze-most-popular-station-count" class="section level1">
<h1>9. Analyze Most Popular Station Count</h1>
<hr>
<div id="a.-most-popular-stations-for-members" class="section level3">
<h3>9a. Most Popular Stations for Members</h3>
<p>Let’s study which <code>start_station_name</code> has the highest
count. Let’s analyze both <code>start_station_name</code> and
<code>end_station_name</code>. Also, it’s important to separate them
based on membership types (casual vs. member). Let’s begin with
<code>start_station_name</code>:</p>
<pre class="r"><code>start_station_name_count_member &lt;- cyclistic_2022_cleaned %&gt;% filter(member_casual == &#39;member&#39;) %&gt;% group_by(start_station_name) %&gt;% count(start_station_name)</code></pre>
<p><br> Now, let’s do the same for <code>end_station_name</code>:</p>
<pre class="r"><code>end_station_name_count_member &lt;- cyclistic_2022_cleaned %&gt;% filter(member_casual == &#39;member&#39;) %&gt;% group_by(end_station_name) %&gt;% count(end_station_name)</code></pre>
<p><br> Apparently, some of the same stations still conquer the top
results.</p>
<p>Now let’s use <code>full_join</code> to combine them:</p>
<pre class="r"><code>station_name_count_member &lt;- full_join(start_station_name_count_member, end_station_name_count_member, by = c(&quot;start_station_name&quot;=&quot;end_station_name&quot;))</code></pre>
<p><br> and then, use <code>if-else</code> statement to get the total
counts:</p>
<pre class="r"><code>station_name_count_member &lt;- station_name_count_member %&gt;% mutate(n_total = if(!any(is.na(c(n.x, n.y)))) { n.x + n.y } else if(is.na(n.y)) { n.x } else { n.y })</code></pre>
<p><br> The above line will create a result where it shows the total
count from both <code>start_station_name</code> and
<code>end_station_name</code>.</p>
<p>Next, re-organize the data a little bit so they look better:</p>
<pre class="r"><code>station_name_count_member &lt;- rename(station_name_count_member, station_name = start_station_name)

station_name_count_member &lt;- station_name_count_member %&gt;% select(-n.x, -n.y) %&gt;% arrange(desc(n_total))</code></pre>
<p><br> Now the column name looks better, and unnecessary columns have
been cleaned as well.<br><br></p>
</div>
<div id="b.-most-popular-stations-for-casuals" class="section level3">
<h3>9b. Most Popular Stations for Casuals</h3>
<p>let’s start with <code>start_station_name</code>:</p>
<pre class="r"><code>start_station_name_count_casual &lt;- cyclistic_2022_cleaned %&gt;% filter(member_casual == &#39;casual&#39;) %&gt;% group_by(start_station_name) %&gt;% count(start_station_name)</code></pre>
<p><br> Next, do the same for <code>end_station_name</code>:</p>
<pre class="r"><code>end_station_name_count_casual &lt;- cyclistic_2022_cleaned %&gt;% filter(member_casual == &#39;casual&#39;) %&gt;% group_by(end_station_name) %&gt;% count(end_station_name)</code></pre>
<p><br> And just like before, use <code>full_join</code>:</p>
<pre class="r"><code>station_name_count_casual &lt;- full_join(start_station_name_count_casual, end_station_name_count_casual, by = c(&quot;start_station_name&quot;=&quot;end_station_name&quot;))</code></pre>
<p><br> Now let’s use <code>if-else</code> statement:</p>
<pre class="r"><code>station_name_count_casual &lt;- station_name_count_casual %&gt;% mutate(n_total = if(!any(is.na(c(n.x, n.y)))) { n.x + n.y } else if(is.na(n.y)) { n.x } else { n.y })</code></pre>
<p><br> Next, re-organize the data a little bit:</p>
<pre class="r"><code>station_name_count_casual &lt;- rename(station_name_count_casual, station_name = start_station_name)

station_name_count_casual &lt;- station_name_count_casual %&gt;% select(-n.x, -n.y) %&gt;% arrange(desc(n_total))</code></pre>
<p><br><br></p>
</div>
</div>
<div id="analyze-popular-days-of-week-and-dates" class="section level1">
<h1>10. Analyze Popular Days of Week and Dates</h1>
<hr>
<p>Let’s see which day is the most popular:</p>
<pre class="r"><code>cyclistic_2022_cleaned %&gt;% group_by(day_of_week) %&gt;% count(day_of_week) %&gt;% arrange(desc(n))</code></pre>
<p><br> Next, separate them by member and casual:</p>
<pre class="r"><code>day_of_week_count &lt;- cyclistic_2022_cleaned %&gt;% group_by(day_of_week, member_casual) %&gt;% count(day_of_week) %&gt;% arrange(desc(n))</code></pre>
<p><br> For now let’s save this result as
<code>day_of_week_count</code>.</p>
<p>Next, let’s analyze the popular dates and group them by either week
or month. First, let’s get the week and the month to check them
better:</p>
<pre class="r"><code>    clean_week_and_month &lt;- cyclistic_2022_cleaned %&gt;% mutate(week = week(started_at), month = month(started_at)) </code></pre>
<p><br> After some considerations, I believe analyzing the data by month
makes more sense and much simpler than by week, because we will try to
see if the trends change following the seasons in the city of Chicago.
In this case, let’s differentiate the most popular dates between members
and casuals to see their differences:</p>
<pre class="r"><code>popular_dates_member_count &lt;- clean_week_and_month %&gt;% filter(member_casual == &#39;member&#39;) %&gt;% group_by(month, day_of_week) %&gt;% count(month) %&gt;% arrange(desc(n))</code></pre>
<p><br> and</p>
<pre class="r"><code>    popular_dates_casual_count &lt;- clean_week_and_month %&gt;% filter(member_casual == &#39;casual&#39;) %&gt;% group_by(month, day_of_week) %&gt;% count(month) %&gt;% arrange(desc(n))</code></pre>
<p><br> From a quick glance, the trends look different between them.
<br><br></p>
</div>
<div id="analyze-most-popular-hours-of-the-day" class="section level1">
<h1>11. Analyze Most Popular Hours of the Day</h1>
<hr>
<p>After analyzing popular days of week and dates, time to do similar
analysis, but for the hours.</p>
<p>Let’s start with total count for all (both casuals and members):</p>
<pre class="r"><code>clean_hour &lt;- cyclistic_2022_cleaned

clean_hour$started_at &lt;- format(clean_hour$started_at, &quot;%H&quot;)

clean_hour %&gt;% group_by(started_at) %&gt;% count(started_at) %&gt;% arrange(desc(n))</code></pre>
<p><br> Next, let’s divide them by the casual or member groups.</p>
<pre class="r"><code>popular_hours_member_count &lt;- clean_hour %&gt;% filter(member_casual == &#39;member&#39;) %&gt;% group_by(started_at, member_casual) %&gt;% count(started_at) %&gt;% arrange(desc(n))</code></pre>
<p><br> and</p>
<pre class="r"><code>popular_hours_casual_count &lt;- clean_hour %&gt;% filter(member_casual == &#39;casual&#39;) %&gt;% group_by(started_at, member_casual) %&gt;% count(started_at) %&gt;% arrange(desc(n))</code></pre>
<p><br> It looks like members are more likely to use the bikes for work
commute and weekday routines. On the other hand, casuals don’t use the
bikes as much during the commute hours in the morning, but they still
use the bikes often during commute hours in the evening.<br><br></p>
</div>
<div id="analyze-ride-length-difference-between-casuals-and-members"
class="section level1">
<h1>12. Analyze Ride Length Difference Between Casuals and Members</h1>
<hr>
<p>Earlier, I calculated the <code>ride_length</code> by calculating the
difference between <code>started_at</code> and
<code>ended_at</code>.</p>
<p>To calculate <code>average ride_length</code> in minutes, let’s just
convert <code>ride_length</code> to minutes:</p>
<pre class="r"><code>ride_length_avg &lt;- cyclistic_2022_cleaned %&gt;% mutate(ride_length_in_minutes = as.numeric(ride_length / 60)) %&gt;% group_by(member_casual) %&gt;% summarize(avg_ride_length_in_minutes = mean(ride_length_in_minutes))</code></pre>
<p><br> The above code provides <code>average ride_length</code> in
minutes, and compare them between members and casuals.<br><br></p>
</div>
<div id="analyze-bike-types" class="section level1">
<h1>13. Analyze Bike Types</h1>
<hr>
<p>Let’s start with this:</p>
<pre class="r"><code>rideable_type_count &lt;- cyclistic_2022_cleaned %&gt;% group_by(rideable_type, member_casual) %&gt;% count(rideable_type) %&gt;% arrange(desc(n))</code></pre>
<p><br> Next, check how many total trips they have between members
vs. casuals:</p>
<pre class="r"><code>member_vs_casual_count &lt;- cyclistic_2022_cleaned %&gt;% group_by(member_casual) %&gt;% count(member_casual) %&gt;% arrange(desc(n))</code></pre>
<p><br> From the above code, looks like members make much more trips as
compared to casuals. For further analysis, use <code>inner join</code>
and <code>mutate</code> to see the percentages from each group:</p>
<pre class="r"><code>rideable_type_count_and_percentage &lt;- inner_join(rideable_type_count, member_vs_casual_count, by = c(&quot;member_casual&quot;=&quot;member_casual&quot;)) %&gt;% mutate(trips_percentage = n.x / n.y)</code></pre>
<p><br> The last code will allow us to see the percentage of members
that use classic bikes vs. electric bikes, and percentage of casuals
that use classic bikes vs. electric bikes. vs docked bikes.</p>
<p>After I checked <code>rideable_type_count_and_percentage</code>, I
realized it’s better to separate the <code>member_casual</code>
group:</p>
<pre class="r"><code>rideable_type_casual &lt;- rideable_type_count_and_percentage %&gt;% filter(member_casual == &#39;casual&#39;) %&gt;% select(-n.x, -n.y)</code></pre>
<p><br> and</p>
<pre class="r"><code>rideable_type_member &lt;- rideable_type_count_and_percentage %&gt;% filter(member_casual == &#39;member&#39;) %&gt;% select(-n.x, -n.y)</code></pre>
<p><br><br></p>
</div>
<div id="pre-visualization---find-latitude-and-longitude"
class="section level1">
<h1>14. Pre-Visualization - Find Latitude and Longitude:</h1>
<hr>
<p>Before data visualization, it’s important to get latitude and
longitude for the station names. I will visualize the station name
counts with <code>leaflet</code>, so it’s important to get an external
dataset for this.</p>
<p>Get the .csv file from here:
<a href="https://data.cityofchicago.org/Transportation/Divvy-Bicycle-Stations/bbyy-e7gq/data#revert" target=_blank>https://data.cityofchicago.org</a></p>
<p>Change the column name from <b>Station Name</b> to
<b>Station_Name</b> so it will be easier to analyze and clean.</p>
<p>Then, go back to RStudio:</p>
<pre class="r"><code>divvy_bicycle_stations &lt;- read_csv(&quot;Divvy_Bicycle_Stations.csv&quot;)</code></pre>
<p><br> Next, need to clean <code>divvy_bicycle_stations</code> because
some station names have <b>*</b>, <b>(Temp)</b>, and <b>- Charging</b>,
just like before. Since I have combined duplicate station names in the
analysis stage before, I need to make sure to have the same consistent
naming process here. Because the idea here is to get the latitude and
longitude with <code>join()</code> function.</p>
<p>The cleaning process:</p>
<pre class="r"><code>divvy_bicycle_stations$Station_Name &lt;- gsub(&quot;\\*&quot;, &quot;&quot;, divvy_bicycle_stations$Station_Name)

divvy_bicycle_stations$Station_Name &lt;- gsub(&quot;\\(Temp)&quot;, &quot;&quot;, divvy_bicycle_stations$Station_Name)

divvy_bicycle_stations$Station_Name &lt;- gsub(&quot;\\ - Charging&quot;, &quot;&quot;, divvy_bicycle_stations$Station_Name)

divvy_bicycle_stations$Station_Name &lt;- gsub(&quot;^\\s+|\\s+$&quot;, &quot;&quot;, divvy_bicycle_stations$Station_Name)</code></pre>
<p><br> Then use <code>left_join</code> to include the latitude and
longitude numbers:</p>
<pre class="r"><code>station_name_count_member_with_location &lt;- left_join(station_name_count_member, divvy_bicycle_stations, by = c(&quot;station_name&quot;=&quot;Station_Name&quot;))</code></pre>
<p><br> It looks like some stations still do not have latitude and
longitude values. It turns out that the dataset from
<i>cityofchicago</i> is not complete enough. Let’s export
<code>station_name_count_member_with_location</code> to .csv and let’s
handle the rest of latitude and longitude manually with Excel.</p>
<p>I manually include latitude and longitude by going to Google Maps and
by searching for them in the <i>cityofchicago</i> website. I fill in all
the latitude and longitude numbers manually in Excel, after I used
<b>Conditional Formatting</b> to highlight <b>NA</b> values.</p>
<p>Next, let’s save the updated .csv file to the Rstudio folder, and
let’s import it back:</p>
<pre class="r"><code>station_name_count_member_with_location &lt;- read_csv(&quot;updated_station_name_count_member_with_location.csv&quot;)</code></pre>
<p><br> Now everything looks much better.</p>
<p>And since I have manually updated the .csv earlier using Excel, I can
just overwrite <code>divvy_bicycle_stations</code> with the updated
longitude and latitude, and then use <code>left_join</code> for
<code>station_name_count_casual</code>:</p>
<pre class="r"><code>divvy_bicycle_stations &lt;- station_name_count_member_with_location %&gt;% select(-n_total)

station_name_count_casual_with_location &lt;- left_join(station_name_count_casual, divvy_bicycle_stations, by = c(&quot;station_name&quot;=&quot;station_name&quot;))</code></pre>
<p><br> These two files with latitude and longitude, I will visualize
them with leaflet.<br><br></p>
</div>
<div id="data-visualization" class="section level1">
<h1>15. Data Visualization</h1>
<hr>
<div id="leaflet-for-station_name_count_member" class="section level3">
<h3>1. Leaflet for station_name_count_member:</h3>
<p>Let’s start with <code>leaflet</code>. From my experience, they look
better than plotly for data visualization with OpenStreetMap. Let’s
start with the palette and text, which will be used for
<code>leaflet()</code>:</p>
<pre class="r"><code>mypalette &lt;- colorBin(
    palette =&quot;plasma&quot;,
    domain = station_name_count_member_with_location$n_total,
    na.color = &quot;transparent&quot;, 
    bins = 6
)</code></pre>
<p><br> next, let’s go with the text:</p>
<pre class="r"><code>mytext &lt;- paste(
    &quot;&lt;b&gt;Station:&lt;/b&gt;&quot;, station_name_count_member_with_location$station_name, &quot;&lt;br /&gt;&quot;,
    &quot;&lt;b&gt;Counts:&lt;/b&gt;&quot;, station_name_count_member_with_location$n_total) %&gt;%
    lapply(htmltools::HTML)</code></pre>
<p><br> then, let’s use both <code>mytext</code> and
<code>mypalette</code> for <code>leaflet()</code>:</p>
<pre class="r"><code>leaflet_for_station_name_count_member &lt;- leaflet(station_name_count_member_with_location) %&gt;%
    addTiles() %&gt;%
    setView(
        lng = -87.6298, lat = 41.8781, zoom = 12
    ) %&gt;%
    
    addCircleMarkers(
        ~ Longitude, ~ Latitude, 
        fillColor = ~ mypalette(n_total), 
        fillOpacity = 0.7, 
        color = &quot;white&quot;, 
        radius = 7, 
        stroke = FALSE,
        label = mytext,
        labelOptions = labelOptions(
            style = list( 
                &quot;font-weight&quot; = &quot;normal&quot;, 
                padding = &quot;3px 8px&quot;
            ), 
            textsize = &quot;13px&quot;, 
            direction = &quot;auto&quot;
        ) 
    ) %&gt;%
    
    addLegend( 
        pal = mypalette, 
        values = ~ n_total, 
        opacity = 0.9,
        title = &quot;Station Name Counts&quot;, 
        position = &quot;bottomright&quot;
    )</code></pre>
<p><br><br></p>
</div>
<div id="leaflet-for-station_name_count_casual" class="section level3">
<h3>2. Leaflet for station_name_count_casual:</h3>
<p>Now let’s do the same but for the casual group:</p>
<pre class="r"><code>mypalette2 &lt;- colorBin(
    palette =&quot;plasma&quot;,
    domain = station_name_count_casual_with_location$n_total,
    na.color = &quot;transparent&quot;, 
    bins = 6
)</code></pre>
<p><br> then:</p>
<pre class="r"><code>mytext2 &lt;- paste(
    &quot;&lt;b&gt;Station:&lt;/b&gt;&quot;, station_name_count_casual_with_location$station_name, &quot;&lt;br /&gt;&quot;,
    &quot;&lt;b&gt;Counts:&lt;/b&gt;&quot;, station_name_count_casual_with_location$n_total) %&gt;%
    lapply(htmltools::HTML)</code></pre>
<p><br> and let’s use both <code>mytext2</code> and
<code>mypalette2</code> for <code>leaflet()</code>:</p>
<pre class="r"><code>leaflet_for_station_name_count_casual &lt;- leaflet(station_name_count_casual_with_location) %&gt;%
    addTiles() %&gt;%
    setView(
        lng = -87.6298, lat = 41.8781, zoom = 12
    ) %&gt;%
    
    addCircleMarkers(
        ~ Longitude, ~ Latitude, 
        fillColor = ~ mypalette2(n_total), 
        fillOpacity = 0.7, 
        color = &quot;white&quot;, 
        radius = 7, 
        stroke = FALSE,
        label = mytext2,
        labelOptions = labelOptions(
            style = list( 
                &quot;font-weight&quot; = &quot;normal&quot;, 
                padding = &quot;3px 8px&quot;
            ), 
            textsize = &quot;13px&quot;, 
            direction = &quot;auto&quot;
        ) 
    ) %&gt;%
    
    addLegend( 
        pal = mypalette2, 
        values = ~ n_total, 
        opacity = 0.9,
        title = &quot;Station Name Counts&quot;, 
        position = &quot;bottomright&quot;
    )</code></pre>
<p><br><br></p>
</div>
<div id="ggplot-for-popular-dates" class="section level3">
<h3>3. GGPlot for Popular Dates:</h3>
<p>Now it’s time to visualize the popular dates:</p>
<pre class="r"><code>ggplot_popular_dates_casual_count &lt;- ggplot(
    popular_dates_casual_count, 
    aes(
        x = month,
        y = day_of_week,
        fill = n
    )
) + 
    
    geom_tile (
        color = &quot;white&quot;,
        na.rm = FALSE
    ) +
    
    scale_fill_viridis_b(
        option = &quot;plasma&quot;,
        direction = 1,
        name = &quot;Trip Counts&quot;
    ) +
    
    scale_x_continuous(
        breaks = seq(length = 12),
        labels = c(&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;, &quot;Jun&quot;, 
                   &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;)
    ) +
    
    scale_y_continuous(
        breaks = seq(length = 7),
        labels = c(&quot;Sun&quot;, &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;)
    ) +
    
    ylab(&quot;&quot;) + xlab(&quot;&quot;) + labs(title = &quot;Casual&quot;) +
    
    theme(legend.text = element_text(size = 20),
          legend.title = element_text(size = 22),
          axis.text.x = element_text(size = 20),
          axis.text.y = element_text(size = 20),
          plot.title = element_text(size = 25, color = &quot;#1b9e77&quot;)
    )</code></pre>
<p><br> then, write this code:</p>
<pre class="r"><code>ggplot_popular_dates_member_count &lt;- ggplot(
    popular_dates_member_count, 
    aes(
        x = month,
        y = day_of_week,
        fill = n
    )
) + 
    
    geom_tile (
        color = &quot;white&quot;,
        na.rm = FALSE
    ) +
    
    scale_fill_viridis_b(
        option = &quot;plasma&quot;,
        direction = 1,
        name = &quot;Trip Counts&quot;
    ) +
    
    scale_x_continuous(
        breaks = seq(length = 12),
        labels = c(&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;, &quot;Jun&quot;, 
                   &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;)
    ) +
    
    scale_y_continuous(
        breaks = seq(length = 7),
        labels = c(&quot;Sun&quot;, &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;)
    ) +
    
    ylab(&quot;&quot;) + xlab(&quot;&quot;) + labs(title = &quot;Member&quot;) +
    
    theme(legend.text = element_text(size = 20),
          legend.title = element_text(size = 22),
          axis.text.x = element_text(size = 20),
          axis.text.y = element_text(size = 20),
          plot.title = element_text(size = 25, color = &quot;#d95f02&quot;)
    )</code></pre>
<p><br> Next, combine them using <code>ggarrange()</code> from
<code>ggpubr</code> library:</p>
<pre class="r"><code>ggarrange_popular_dates_comparison &lt;- ggarrange(
    ggplot_popular_dates_casual_count, 
    ggplot_popular_dates_member_count, 
    ncol = 1, 
    nrow = 2,
    common.legend = TRUE, 
    legend = &quot;right&quot;
)</code></pre>
<p><br><br></p>
</div>
<div id="ggplot-for-days-of-week" class="section level3">
<h3>4. GGPlot for Days of Week:</h3>
<p>Let’s use <code>ggplot2</code> again but for days of week count:</p>
<pre class="r"><code>ggplot_day_of_week_count &lt;- ggplot(day_of_week_count, 
       aes(y=n, x=day_of_week, fill=member_casual)) + 
    
    geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;) +
    
    scale_x_continuous(
        breaks = seq(length = 7),
        labels = c(&quot;Sun&quot;, &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;)
    ) +
    
    scale_y_continuous(
        labels = scales::comma
    ) +
    
    scale_fill_brewer(palette = &quot;Dark2&quot;, name = &quot;&quot;) +
    
    ylab(&quot;&quot;) + xlab(&quot;&quot;) + 
    
    theme(legend.text = element_text(size = 20),
    legend.position = &quot;bottom&quot;,
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20)
    )</code></pre>
<p><br><br></p>
</div>
<div id="ggplot-for-popular-hours" class="section level3">
<h3>5. GGPlot for Popular Hours:</h3>
<p>To visualize popular hours, let’s use the same
<code>geom_bar()</code> but with <code>coord_polar(start = 0)</code> to
make it circular:</p>
<pre class="r"><code>ggplot_popular_hours_casual_count &lt;- ggplot(popular_hours_casual_count, 
       aes(y=n, x=started_at)) + 
    
    geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;, fill=&quot;#1b9e77&quot;) +
    
    coord_polar(start = 0) +
    
    theme_minimal() +
    
    labs(title=&quot;Casual&quot;) +
    
    theme(axis.text.y = element_blank(),
          axis.title = element_blank(),
          axis.text.x = element_text(size = 18),
          plot.title = element_text(size = 25, color = &quot;#1b9e77&quot;, hjust = 0.5),
          panel.grid.major = element_line(size = 0.5, color = &quot;grey&quot;),
          panel.grid.minor = element_line(size = 0.25, color = &quot;grey&quot;)
    )</code></pre>
<p><br> and for the members group:</p>
<pre class="r"><code>ggplot_popular_hours_member_count &lt;- ggplot(popular_hours_member_count, 
                                            aes(y=n, x=started_at)) + 
    
    geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;, fill=&quot;#d95f02&quot;) +
    
    coord_polar(start = 0) +
    
    theme_minimal() +
    
    labs(title=&quot;Member&quot;) +
    
    theme(axis.text.y = element_blank(),
          axis.title = element_blank(),
          axis.text.x = element_text(size = 18),
          plot.title = element_text(size = 25, color = &quot;#d95f02&quot;, hjust = 0.5),
          panel.grid.major = element_line(size = 0.5, color = &quot;grey&quot;),
          panel.grid.minor = element_line(size = 0.25, color = &quot;grey&quot;)
    )</code></pre>
<p><br> and then, combine them using <code>ggarrange()</code>:</p>
<pre class="r"><code>ggarrange_popular_hours_comparison &lt;- ggarrange(
    ggplot_popular_hours_casual_count, 
    ggplot_popular_hours_member_count, 
    nrow = 1,
    common.legend = TRUE)</code></pre>
<p><br><br></p>
</div>
<div id="ggplot-for-avg.-ride-length" class="section level3">
<h3>6. GGplot for Avg. Ride Length:</h3>
<p>This one is fairly simple:</p>
<pre class="r"><code>ggplot_ride_length_avg &lt;- ggplot(ride_length_avg, 
       aes(y=member_casual, x=avg_ride_length_in_minutes, fill=member_casual)) + 
    
    geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;) +
    
    scale_fill_brewer(palette = &quot;Dark2&quot;, name = &quot;&quot;) +
    
    ylab(&quot;&quot;) + xlab(&quot;&quot;) + labs(title=&quot;Average Ride Length (Minutes)&quot;) +
    
    theme(legend.text = element_text(size = 40),
          legend.position = &quot;bottom&quot;,
          axis.text.x = element_text(size = 40),
          axis.text.y = element_text(size = 40),
          plot.title = element_text(size = 50)
    )</code></pre>
<p><br><br></p>
</div>
<div id="plotly-for-the-pie-charts" class="section level3">
<h3>7. Plotly for the Pie Charts:</h3>
<p>Technically, I can just use <code>ggplot2</code> once again, but
<code>plotly</code> is far easier to create pie charts:</p>
<pre class="r"><code>plotly_rideable_type_casual &lt;- plot_ly(rideable_type_casual, labels = ~rideable_type, values = ~trips_percentage, type = &#39;pie&#39;,
        textposition = &#39;inside&#39;,
        textinfo = &#39;label+percent&#39;,
        insidetextfont = list(color = &#39;#FFFFFF&#39;, size = 20),
        hoverinfo = &#39;text&#39;,
        text = ~rideable_type,
        marker = list(colors = colors,
                      line = list(color = &#39;#FFFFFF&#39;, width = 1)),
        showlegend = FALSE) %&gt;% 
    layout(annotations = list(x = 0.3, y = 1.05, text = &quot;Casual&quot;, showarrow = F, xref=&#39;paper&#39;, yref=&#39;paper&#39;, xanchor=&#39;right&#39;, yanchor=&#39;auto&#39;, xshift=0, yshift=0, font=list(size=25, color = &#39;#1b9e77&#39;)))</code></pre>
<p><br> next, do the same for the members group:</p>
<pre class="r"><code>plotly_rideable_type_member &lt;- plot_ly(rideable_type_member, labels = ~rideable_type, values = ~trips_percentage, type = &#39;pie&#39;,
       textposition = &#39;inside&#39;,
       textinfo = &#39;label+percent&#39;,
        insidetextfont = list(color = &#39;#FFFFFF&#39;, size = 20),
       hoverinfo = &#39;text&#39;,
       text = ~rideable_type,
       marker = list(colors = colors,
                     line = list(color = &#39;#FFFFFF&#39;, width = 1)),
       showlegend = FALSE) %&gt;% 
    layout(annotations = list(x = 0.3, y = 1.05, text = &quot;Member&quot;, showarrow = F, xref=&#39;paper&#39;, yref=&#39;paper&#39;, xanchor=&#39;right&#39;, yanchor=&#39;auto&#39;, xshift=0, yshift=0, font=list(size=25, color = &#39;#d95f02&#39;)))</code></pre>
<p>I don’t use <code>subplot()</code> to merge above plotly charts, I
just combine the exported images manually.</p>
<p>That’s it. All data visualizations are ready now.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
